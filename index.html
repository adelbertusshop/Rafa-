
<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rafa≈Ç Pistrakiewicz Bau & Renovierung</title>
  <!-- ... (pozosta≈Çe meta tagi pozostajƒÖ bez zmian) ... -->
  
  <style>
    /* ... (pozosta≈Çe style pozostajƒÖ bez zmian) ... */

    /* üîπ PROFESJONALNY CHATBOT - POPRAWIONA WERSJA */
    .chatbot-container {
      position: fixed;
      bottom: 90px;
      right: 20px;
      z-index: 1000;
      font-family: 'Poppins', sans-serif;
    }

    .chatbot-button {
      background: linear-gradient(135deg, #d4af37, #b8941f);
      color: white;
      border: none;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      cursor: pointer;
      box-shadow: 0 4px 20px rgba(212, 175, 55, 0.4);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      transition: all 0.3s ease;
      position: relative;
    }

    .chatbot-button:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 25px rgba(212, 175, 55, 0.6);
    }

    .chatbot-button-pulse {
      position: absolute;
      top: -5px;
      right: -5px;
      width: 20px;
      height: 20px;
      background: #ff4444;
      border-radius: 50%;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% { transform: scale(0.8); opacity: 1; }
      50% { transform: scale(1.2); opacity: 0.7; }
      100% { transform: scale(0.8); opacity: 1; }
    }

    .chatbot-window {
      position: absolute;
      bottom: 70px;
      right: 0;
      width: 380px;
      height: 550px;
      background: white;
      border-radius: 20px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
      display: none;
      flex-direction: column;
      overflow: hidden;
      border: 2px solid #d4af37;
    }

    .chatbot-header {
      background: linear-gradient(135deg, #0a1a2f, #1e3a5f);
      color: white;
      padding: 15px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .chatbot-title {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 600;
    }

    .chatbot-status {
      display: flex;
      align-items: center;
      gap: 5px;
      font-size: 0.8rem;
      opacity: 0.8;
    }

    .status-dot {
      width: 8px;
      height: 8px;
      background: #4CAF50;
      border-radius: 50%;
      animation: statusPulse 2s infinite;
    }

    @keyframes statusPulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    .chatbot-close {
      background: none;
      border: none;
      color: white;
      font-size: 1.2rem;
      cursor: pointer;
      padding: 5px;
      transition: transform 0.3s ease;
    }

    .chatbot-close:hover {
      transform: rotate(90deg);
    }

    .chatbot-messages {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
      background: #f8f9fa;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .message {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      animation: messageSlide 0.3s ease-out;
    }

    @keyframes messageSlide {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .message.bot .avatar {
      background: #d4af37;
      color: white;
      width: 35px;
      height: 35px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
      flex-shrink: 0;
    }

    .message.user {
      justify-content: flex-end;
    }

    .message.user .content {
      background: linear-gradient(135deg, #0a1a2f, #1e3a5f);
      color: white;
      order: -1;
    }

    .message.bot .content {
      background: white;
      color: #333;
      border: 1px solid #e0e0e0;
    }

    .content {
      padding: 12px 16px;
      border-radius: 18px;
      max-width: 80%;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      line-height: 1.4;
      position: relative;
    }

    .message-time {
      font-size: 0.7rem;
      opacity: 0.6;
      margin-top: 5px;
      text-align: right;
    }

    .quick-replies {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 10px;
    }

    .quick-reply {
      background: white;
      border: 1px solid #d4af37;
      color: #d4af37;
      padding: 8px 12px;
      border-radius: 15px;
      font-size: 0.8rem;
      cursor: pointer;
      transition: all 0.3s ease;
      white-space: nowrap;
    }

    .quick-reply:hover {
      background: #d4af37;
      color: white;
      transform: translateY(-2px);
    }

    .suggestions-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
      margin-top: 10px;
    }

    .suggestion-card {
      background: white;
      border: 1px solid #e0e0e0;
      border-radius: 10px;
      padding: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
      font-size: 0.8rem;
    }

    .suggestion-card:hover {
      border-color: #d4af37;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(212, 175, 55, 0.2);
    }

    .chatbot-input-container {
      padding: 15px 20px;
      border-top: 1px solid #e0e0e0;
      background: white;
      display: flex;
      gap: 10px;
      align-items: flex-end;
    }

    .chatbot-input {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .chatbot-input textarea {
      width: 100%;
      padding: 12px 15px;
      border: 1px solid #e0e0e0;
      border-radius: 25px;
      outline: none;
      font-family: 'Poppins', sans-serif;
      resize: none;
      max-height: 100px;
      min-height: 20px;
    }

    .chatbot-input textarea:focus {
      border-color: #d4af37;
    }

    .chatbot-actions {
      display: flex;
      gap: 5px;
    }

    .chatbot-action-btn {
      background: none;
      border: none;
      color: #666;
      cursor: pointer;
      padding: 8px;
      border-radius: 50%;
      transition: all 0.3s ease;
    }

    .chatbot-action-btn:hover {
      background: #f0f0f0;
      color: #d4af37;
    }

    .chatbot-send {
      background: #d4af37;
      color: white;
      border: none;
      border-radius: 50%;
      width: 45px;
      height: 45px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      flex-shrink: 0;
    }

    .chatbot-send:hover {
      background: #b8941f;
      transform: scale(1.05);
    }

    .chatbot-send:disabled {
      background: #cccccc;
      cursor: not-allowed;
      transform: none;
    }

    /* Typing indicator */
    .typing-indicator {
      display: flex;
      align-items: center;
      gap: 5px;
      padding: 10px 15px;
      background: white;
      border-radius: 18px;
      border: 1px solid #e0e0e0;
      width: fit-content;
    }

    .typing-dot {
      width: 8px;
      height: 8px;
      background: #d4af37;
      border-radius: 50%;
      animation: typingAnimation 1.4s infinite ease-in-out;
    }

    .typing-dot:nth-child(1) { animation-delay: -0.32s; }
    .typing-dot:nth-child(2) { animation-delay: -0.16s; }

    @keyframes typingAnimation {
      0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
      40% { transform: scale(1); opacity: 1; }
    }

    /* Quick actions */
    .quick-actions {
      display: flex;
      gap: 10px;
      margin-top: 10px;
      flex-wrap: wrap;
    }

    .quick-action {
      background: linear-gradient(135deg, #d4af37, #b8941f);
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 20px;
      font-size: 0.8rem;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .quick-action:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3);
    }

    /* Responsywno≈õƒá chatbota */
    @media (max-width: 768px) {
      .chatbot-container {
        bottom: 80px;
        right: 10px;
      }

      .chatbot-window {
        width: calc(100vw - 40px);
        height: 70vh;
        right: -10px;
      }

      .chatbot-button {
        width: 55px;
        height: 55px;
        font-size: 1.3rem;
      }

      .suggestions-grid {
        grid-template-columns: 1fr;
      }
    }

    /* Notification badge */
    .notification-badge {
      position: absolute;
      top: -5px;
      right: -5px;
      background: #ff4444;
      color: white;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      font-size: 0.7rem;
      display: flex;
      align-items: center;
      justify-content: center;
      animation: bounce 2s infinite;
    }

    @keyframes bounce {
      0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
      40% { transform: translateY(-5px); }
      60% { transform: translateY(-3px); }
    }
  </style>
</head>
<body class="bg-gray-50 text-gray-900 smooth-scroll">

  <!-- ... (ca≈Ça zawarto≈õƒá strony pozostaje bez zmian) ... -->

  <!-- üîπ PROFESJONALNY CHATBOT - POPRAWIONA WERSJA -->
  <div class="chatbot-container">
    <button class="chatbot-button" onclick="toggleChatbot()">
      <i class="fas fa-comments"></i>
      <div class="notification-badge" id="notificationBadge" style="display: none;">!</div>
    </button>
    <div class="chatbot-window" id="chatbotWindow">
      <div class="chatbot-header">
        <div class="chatbot-title">
          <i class="fas fa-robot"></i>
          <div>
            <span data-pl="Asystent Budowlany" data-de="Bau-Assistent">Asystent Budowlany</span>
            <div class="chatbot-status">
              <div class="status-dot"></div>
              <span data-pl="Online" data-de="Online">Online</span>
            </div>
          </div>
        </div>
        <button class="chatbot-close" onclick="toggleChatbot()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="chatbot-messages" id="chatbotMessages">
        <!-- Wiadomo≈õci bƒôdƒÖ dodawane dynamicznie -->
      </div>
      <div class="chatbot-input-container">
        <div class="chatbot-input">
          <textarea id="chatbotInput" placeholder="Napisz wiadomo≈õƒá..." 
                 data-pl="Napisz wiadomo≈õƒá..." data-de="Schreiben Sie eine Nachricht..."
                 rows="1" oninput="autoResize(this)"></textarea>
          <div class="quick-actions" id="quickActions">
            <button class="quick-action" onclick="quickAction('wycena')">
              <i class="fas fa-euro-sign"></i>
              <span data-pl="Wyce≈Ñ projekt" data-de="Angebot anfordern">Wyce≈Ñ projekt</span>
            </button>
            <button class="quick-action" onclick="quickAction('termin')">
              <i class="fas fa-calendar"></i>
              <span data-pl="Um√≥w termin" data-de="Termin vereinbaren">Um√≥w termin</span>
            </button>
            <button class="quick-action" onclick="quickAction('kontakt')">
              <i class="fas fa-phone"></i>
              <span data-pl="Zadzwo≈Ñ" data-de="Anrufen">Zadzwo≈Ñ</span>
            </button>
          </div>
        </div>
        <div class="chatbot-actions">
          <button class="chatbot-action-btn" onclick="attachFile()" title="Za≈ÇƒÖcz plik">
            <i class="fas fa-paperclip"></i>
          </button>
          <button class="chatbot-send" id="sendButton" onclick="sendMessage()">
            <i class="fas fa-paper-plane"></i>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- ... (reszta strony pozostaje bez zmian) ... -->

  <script>
    // ========== PROFESJONALNY CHATBOT - POPRAWIONA WERSJA ==========
    let isChatbotOpen = false;
    let currentLang = localStorage.getItem('preferredLang') || 'pl';
    let conversationHistory = [];
    let userName = '';
    let userProject = null;

    // Rozszerzona baza wiedzy chatbota
    const chatbotKnowledge = {
      pl: {
        greetings: ['cze≈õƒá', 'hej', 'dzie≈Ñ dobry', 'witam', 'siema', 'hello', 'dobry'],
        farewells: ['dziƒôkujƒô', 'dziƒôki', 'do widzenia', 'pa', 'nara', 'koniec', 'stop'],
        services: {
          'sucha zabudowa': {
            description: 'Specjalizujemy siƒô w kompleksowej suchej zabudowie: ≈õcianki dzia≈Çowe z p≈Çyty g-k, sufity podwieszane, zabudowy meblowe. U≈ºywamy materia≈Ç√≥w Knauf, Rigips i innych sprawdzonych marek.',
            details: '‚Ä¢ ≈öcianki dzia≈Çowe\n‚Ä¢ Sufity podwieszane\n‚Ä¢ Zabudowy meblowe\n‚Ä¢ Prace izolacyjne\n‚Ä¢ Monta≈º p≈Çyt gipsowo-kartonowych',
            time: '2-4 tygodnie',
            warranty: '24 miesiƒÖce'
          },
          'szpachlowanie i malowanie': {
            description: 'Profesjonalne szpachlowanie i malowanie z pe≈Çnym przygotowaniem powierzchni. Gwarantujemy idealnie g≈Çadkie ≈õciany i trwa≈Çe wyko≈Ñczenie.',
            details: '‚Ä¢ Przygotowanie powierzchni\n‚Ä¢ Szpachlowanie maszynowe\n‚Ä¢ Gruntowanie\n‚Ä¢ Malowanie farbami lateksowymi\n‚Ä¢ Zabezpieczenie mebli i pod≈Ç√≥g',
            time: '1-3 tygodnie',
            warranty: '36 miesiƒôcy na malowanie'
          },
          'kompleksowe wyko≈Ñczenia': {
            description: 'Kompletne wyko≈Ñczenia wnƒôtrz: tapety, p≈Çytki, pod≈Çogi winylowe, panele. Zajmujemy siƒô wszystkim od demonta≈ºu po sprzƒÖtanie.',
            details: '‚Ä¢ Uk≈Çadanie p≈Çytek\n‚Ä¢ Monta≈º paneli pod≈Çogowych\n‚Ä¢ Tapetowanie\n‚Ä¢ Monta≈º listew przypod≈Çogowych\n‚Ä¢ SprzƒÖtanie po pracach',
            time: '3-6 tygodni',
            warranty: '24 miesiƒÖce'
          },
          'ocieplenia i elewacje': {
            description: 'Kompleksowe ocieplenia budynk√≥w metodƒÖ lekkƒÖ mokrƒÖ (ETICS) i prace elewacyjne zgodnie z niemieckimi normami budowlanymi.',
            details: '‚Ä¢ Ocieplenie styropianem/pianƒÖ PUR\n‚Ä¢ Tynki strukturalne\n‚Ä¢ Malowanie elewacji\n‚Ä¢ Docieplenie poddasza\n‚Ä¢ Systemy ocieple≈Ñ Knauf, Sto',
            time: '4-8 tygodni',
            warranty: '10 lat na ocieplenie'
          },
          'monta≈º okien i drzwi': {
            description: 'Profesjonalny monta≈º okien PVC, drewnianych, aluminiowych oraz drzwi z pe≈Çnym uszczelnieniem i wyko≈Ñczeniem.',
            details: '‚Ä¢ Demonta≈º stolarki\n‚Ä¢ Monta≈º nowych okien/drzwi\n‚Ä¢ Uszczelnienie pianƒÖ\n‚Ä¢ Monta≈º parapet√≥w\n‚Ä¢ Wyko≈Ñczenie fugƒÖ',
            time: '1-2 tygodnie',
            warranty: '60 miesiƒôcy na monta≈º'
          },
          'remonty kompleksowe': {
            description: 'Kompleksowe remonty mieszka≈Ñ i dom√≥w od stanu deweloperskiego do pod klucz. ZarzƒÖdzamy ca≈Çym procesem.',
            details: '‚Ä¢ Projekt funkcjonalny\n‚Ä¢ Prace budowlane\n‚Ä¢ Instalacje elektryczne\n‚Ä¢ Instalacje hydrauliczne\n‚Ä¢ Wyko≈Ñczenia\n‚Ä¢ SprzƒÖtanie',
            time: '8-16 tygodni',
            warranty: '48 miesiƒôcy'
          }
        },
        prices: {
          'sucha zabudowa': '45-75‚Ç¨/m¬≤ (w zale≈ºno≈õci od materia≈Ç√≥w i z≈Ço≈ºono≈õci)',
          'szpachlowanie i malowanie': 'Szpachlowanie: 15-25‚Ç¨/m¬≤, Malowanie: 8-15‚Ç¨/m¬≤',
          'kompleksowe wyko≈Ñczenia': 'Tapety: 20-35‚Ç¨/m¬≤, P≈Çytki: 45-80‚Ç¨/m¬≤, Pod≈Çogi: 25-45‚Ç¨/m¬≤',
          'ocieplenia i elewacje': '120-180‚Ç¨/m¬≤ (system kompletny z materia≈Çami)',
          'monta≈º okien i drzwi': 'Okno: 150-300‚Ç¨/szt, Drzwi: 200-500‚Ç¨/szt',
          'remonty kompleksowe': 'od 400‚Ç¨/m¬≤ (w zale≈ºno≈õci od standardu)'
        },
        areas: ['berlin', 'brandenburgia', 'bawaria', 'monachium', 'hamburg', 'd√ºsseldorf', 'kolonia', 'frankfurt', 'hesja', 'dolna saksonia', 'nadrenia'],
        responses: {
          greeting: 'üëã Cze≈õƒá! Jestem asystentem Rafa≈Ça Pistrakiewicza. Specjalizujemy siƒô w us≈Çugach budowlanych w Niemczech. Jak mogƒô Ci pom√≥c?',
          greeting_with_name: 'üëã Cze≈õƒá {name}! Mi≈Ço Ciƒô poznaƒá. W czym mogƒô pom√≥c?',
          service_question: 'Kt√≥ra us≈Çuga Ciƒô interesuje? Mo≈ºesz wybraƒá z listy lub opisaƒá sw√≥j projekt.',
          price_question: 'Czy chcesz poznaƒá przybli≈ºone ceny kt√≥rej≈õ z naszych us≈Çug?',
          area_question: 'W jakim regionie Niemiec znajduje siƒô Tw√≥j projekt?',
          contact_info: 'üìû **Telefon:** +49 694 526 240\nüì± **Mobile:** +49 1516 3675 548\n‚úâÔ∏è **Email:** pistrakiewicz@gmail.com\nüïí **Godziny:** Pon-Pt 7:00-18:00, Sob 8:00-14:00',
          appointment_setup: '≈öwietnie! Aby um√≥wiƒá dok≈Çadny termin, proszƒô o podanie:\n‚Ä¢ Lokalizacji projektu\n‚Ä¢ Przybli≈ºonej wielko≈õci/m¬≤\n‚Ä¢ Preferowanego terminu\nAlbo zadzwo≈Ñ bezpo≈õrednio: +49 694 526 240',
          quote_request: 'Chƒôtnie przygotujemy wycenƒô! Potrzebujƒô:\n‚Ä¢ Rodzaj prac\n‚Ä¢ Powierzchnia w m¬≤\n‚Ä¢ Stan obecny (zdjƒôcia mile widziane)\n‚Ä¢ Termin realizacji',
          thanks: 'Dziƒôkujƒô za rozmowƒô! ü§ù Pamiƒôtaj, zawsze mo≈ºesz zadzwoniƒá bezpo≈õrednio pod +49 694 526 240. Powodzenia z projektem!',
          default: 'Rozumiem, ≈ºe pytasz o "{query}". Jeste≈õmy w stanie pom√≥c Ci z tym! Czy chcesz poznaƒá szczeg√≥≈Çy tej us≈Çugi, przybli≈ºone koszty, czy mo≈ºe um√≥wiƒá siƒô na bezp≈ÇatnƒÖ wycenƒô?',
          file_instruction: 'Mo≈ºesz tak≈ºe przes≈Çaƒá zdjƒôcia lub pliki projektu - kliknij spinacz obok pola tekstowego.'
        }
      },
      de: {
        greetings: ['hallo', 'guten tag', 'hi', 'guten morgen', 'moin', 'guten abend'],
        farewells: ['danke', 'dankesch√∂n', 'auf wiedersehen', 'tsch√ºss', 'ciao', 'ende', 'stop'],
        services: {
          'trockenbau': {
            description: 'Wir spezialisieren uns auf umfassenden Trockenbau: Trennw√§nde aus Gipskarton, abgeh√§ngte Decken, M√∂belelemente. Wir verwenden Materialien von Knauf, Rigips und anderen gepr√ºften Marken.',
            details: '‚Ä¢ Trennw√§nde\n‚Ä¢ Abgeh√§ngte Decken\n‚Ä¢ M√∂belbau\n‚Ä¢ Isolierarbeiten\n‚Ä¢ Montage von Gipskartonplatten',
            time: '2-4 Wochen',
            warranty: '24 Monate'
          },
          'spachteln und malern': {
            description: 'Professionelles Spachteln und Malern mit vollst√§ndiger Oberfl√§chenvorbereitung. Wir garantieren perfekt glatte W√§nde und langlebige Beschichtungen.',
            details: '‚Ä¢ Oberfl√§chenvorbereitung\n‚Ä¢ Maschinelles Spachteln\n‚Ä¢ Grundierung\n‚Ä¢ Malen mit Latexfarben\n‚Ä¢ M√∂bel- und Bodenschutz',
            time: '1-3 Wochen',
            warranty: '36 Monate auf Malerarbeiten'
          },
          'komplette innenausbauten': {
            description: 'Komplette Innenausbauten: Tapeten, Fliesen, Vinylb√∂den, Paneele. Wir k√ºmmern uns um alles vom Abbruch bis zur Endreinigung.',
            details: '‚Ä¢ Fliesenverlegung\n‚Ä¢ Bodenbelagsmontage\n‚Ä¢ Tapezieren\n‚Ä¢ Montage von Sockelleisten\n‚Ä¢ Endreinigung',
            time: '3-6 Wochen',
            warranty: '24 Monate'
          },
          'w√§rmed√§mmung und fassaden': {
            description: 'Umfassende Geb√§uded√§mmung mit WDVS und Fassadenarbeiten nach deutschen Baunormen.',
            details: '‚Ä¢ D√§mmung mit EPS/PUR\n‚Ä¢ Strukturputze\n‚Ä¢ Fassadenanstrich\n‚Ä¢ Dachbodend√§mmung\n‚Ä¢ D√§mmsysteme Knauf, Sto',
            time: '4-8 Wochen',
            warranty: '10 Jahre auf D√§mmung'
          },
          'fenster- und t√ºreneinbau': {
            description: 'Professioneller Einbau von PVC-, Holz-, Aluminiumfenstern und T√ºren mit vollst√§ndiger Abdichtung und Ausbau.',
            details: '‚Ä¢ Demontage alter Elemente\n‚Ä¢ Einbau neuer Fenster/T√ºren\n‚Ä¢ Abdichtung mit Schaum\n‚Ä¢ Fensterbankmontage\n‚Ä¢ Fugenschluss',
            time: '1-2 Wochen',
            warranty: '60 Monate auf Einbau'
          },
          'komplette renovierungen': {
            description: 'Komplette Renovierung von Wohnungen und H√§usern vom Rohbau bis zur Schl√ºssel√ºbergabe. Wir managen den gesamten Prozess.',
            details: '‚Ä¢ Funktionsplanung\n‚Ä¢ Bauarbeiten\n‚Ä¢ Elektroinstallation\n‚Ä¢ Sanit√§rinstallation\n‚Ä¢ Ausbauarbeiten\n‚Ä¢ Endreinigung',
            time: '8-16 Wochen',
            warranty: '48 Monate'
          }
        },
        prices: {
          'trockenbau': '45-75‚Ç¨/m¬≤ (abh√§ngig von Materialien und Komplexit√§t)',
          'spachteln und malern': 'Spachteln: 15-25‚Ç¨/m¬≤, Malern: 8-15‚Ç¨/m¬≤',
          'komplette innenausbauten': 'Tapeten: 20-35‚Ç¨/m¬≤, Fliesen: 45-80‚Ç¨/m¬≤, B√∂den: 25-45‚Ç¨/m¬≤',
          'w√§rmed√§mmung und fassaden': '120-180‚Ç¨/m¬≤ (Komplettsystem mit Materialien)',
          'fenster- und t√ºreneinbau': 'Fenster: 150-300‚Ç¨/St√ºck, T√ºren: 200-500‚Ç¨/St√ºck',
          'komplette renovierungen': 'ab 400‚Ç¨/m¬≤ (abh√§ngig vom Standard)'
        },
        areas: ['berlin', 'brandenburg', 'bayern', 'm√ºnchen', 'hamburg', 'd√ºsseldorf', 'k√∂ln', 'frankfurt', 'hessen', 'niedersachsen', 'nordrhein'],
        responses: {
          greeting: 'üëã Hallo! Ich bin der Assistent von Rafa≈Ç Pistrakiewicz. Wir spezialisieren uns auf Baudienstleistungen in Deutschland. Wie kann ich Ihnen helfen?',
          greeting_with_name: 'üëã Hallo {name}! Sch√∂n, Sie kennenzulernen. Womit kann ich helfen?',
          service_question: 'Welche Dienstleistung interessiert Sie? Sie k√∂nnen aus der Liste w√§hlen oder Ihr Projekt beschreiben.',
          price_question: 'M√∂chten Sie ungef√§hre Preise f√ºr einen unserer Dienste erfahren?',
          area_question: 'In welcher Region Deutschlands befindet sich Ihr Projekt?',
          contact_info: 'üìû **Telefon:** +49 694 526 240\nüì± **Mobil:** +49 1516 3675 548\n‚úâÔ∏è **Email:** pistrakiewicz@gmail.com\nüïí **√ñffnungszeiten:** Mo-Fr 7:00-18:00, Sa 8:00-14:00',
          appointment_setup: 'Gro√üartig! Um einen genauen Termin zu vereinbaren, ben√∂tige ich:\n‚Ä¢ Projektstandort\n‚Ä¢ Ungef√§hre Gr√∂√üe/m¬≤\n‚Ä¢ Bevorzugter Zeitraum\nOder rufen Sie direkt an: +49 694 526 240',
          quote_request: 'Gerne erstellen wir ein Angebot! Ich ben√∂tige:\n‚Ä¢ Art der Arbeiten\n‚Ä¢ Fl√§che in m¬≤\n‚Ä¢ Aktueller Zustand (Fotos erw√ºnscht)\n‚Ä¢ Realisierungszeitraum',
          thanks: 'Vielen Dank f√ºr das Gespr√§ch! ü§ù Denken Sie daran, Sie k√∂nnen immer direkt unter +49 694 526 240 anrufen. Viel Erfolg mit Ihrem Projekt!',
          default: 'Ich verstehe, dass Sie nach "{query}" fragen. Wir k√∂nnen Ihnen dabei helfen! M√∂chten Sie Details zu diesem Service, ungef√§hre Kosten erfahren oder ein kostenloses Angebot vereinbaren?',
          file_instruction: 'Sie k√∂nnen auch Fotos oder Projektdateien senden - klicken Sie auf die B√ºroklammer neben dem Textfeld.'
        }
      }
    };

    // Rozszerzone funkcje chatbota
    function toggleChatbot() {
      const chatbotWindow = document.getElementById('chatbotWindow');
      const notificationBadge = document.getElementById('notificationBadge');
      isChatbotOpen = !isChatbotOpen;
      
      if (isChatbotOpen) {
        chatbotWindow.style.display = 'flex';
        notificationBadge.style.display = 'none';
        
        // Dodaj powitalnƒÖ wiadomo≈õƒá je≈õli chat jest pusty
        if (document.getElementById('chatbotMessages').children.length === 0) {
          showWelcomeMessage();
        }
        document.getElementById('chatbotInput').focus();
      } else {
        chatbotWindow.style.display = 'none';
      }
    }

    function showWelcomeMessage() {
      const lang = currentLang;
      const knowledge = chatbotKnowledge[lang];
      
      addBotMessage(knowledge.responses.greeting);
      
      // Dodaj sugestie us≈Çug
      setTimeout(() => {
        showServiceSuggestions();
      }, 1000);
    }

    function showServiceSuggestions() {
      const lang = currentLang;
      const services = Object.keys(chatbotKnowledge[lang].services);
      const messagesContainer = document.getElementById('chatbotMessages');
      
      const suggestionDiv = document.createElement('div');
      suggestionDiv.className = 'suggestions-grid';
      
      services.forEach(service => {
        const serviceCard = document.createElement('div');
        serviceCard.className = 'suggestion-card';
        serviceCard.textContent = service.charAt(0).toUpperCase() + service.slice(1);
        serviceCard.onclick = () => sendQuickMessage(service);
        suggestionDiv.appendChild(serviceCard);
      });
      
      messagesContainer.appendChild(suggestionDiv);
      messagesContainer.scrollTop = messagesContainer.scrollHeight;
    }

    function autoResize(textarea) {
      textarea.style.height = 'auto';
      textarea.style.height = Math.min(textarea.scrollHeight, 100) + 'px';
      
      // Enable/disable send button
      const sendButton = document.getElementById('sendButton');
      sendButton.disabled = textarea.value.trim() === '';
    }

    function addMessage(text, isUser = false, showTime = true) {
      const messagesContainer = document.getElementById('chatbotMessages');
      const messageDiv = document.createElement('div');
      messageDiv.className = `message ${isUser ? 'user' : 'bot'}`;
      
      if (!isUser) {
        const avatar = document.createElement('div');
        avatar.className = 'avatar';
        avatar.innerHTML = '<i class="fas fa-robot"></i>';
        messageDiv.appendChild(avatar);
      }
      
      const content = document.createElement('div');
      content.className = 'content';
      
      // Formatowanie tekstu z **pogrubieniem**
      const formattedText = text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
      content.innerHTML = formattedText.replace(/\n/g, '<br>');
      
      if (showTime) {
        const time = document.createElement('div');
        time.className = 'message-time';
        time.textContent = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        content.appendChild(time);
      }
      
      messageDiv.appendChild(content);
      messagesContainer.appendChild(messageDiv);
      messagesContainer.scrollTop = messagesContainer.scrollHeight;
      
      // Zapisz w historii
      conversationHistory.push({
        text: text,
        isUser: isUser,
        timestamp: new Date().toISOString()
      });
    }

    function addBotMessage(text) {
      addMessage(text, false);
    }

    function addUserMessage(text) {
      addMessage(text, true);
    }

    function simulateTyping() {
      const messagesContainer = document.getElementById('chatbotMessages');
      const typingDiv = document.createElement('div');
      typingDiv.className = 'message bot';
      
      const avatar = document.createElement('div');
      avatar.className = 'avatar';
      avatar.innerHTML = '<i class="fas fa-robot"></i>';
      typingDiv.appendChild(avatar);
      
      const typingIndicator = document.createElement('div');
      typingIndicator.className = 'typing-indicator';
      typingIndicator.innerHTML = `
        <div class="typing-dot"></div>
        <div class="typing-dot"></div>
        <div class="typing-dot"></div>
      `;
      typingDiv.appendChild(typingIndicator);
      
      messagesContainer.appendChild(typingDiv);
      messagesContainer.scrollTop = messagesContainer.scrollHeight;
      
      return typingDiv;
    }

    function processMessage(message) {
      const lang = currentLang;
      const knowledge = chatbotKnowledge[lang];
      const lowerMessage = message.toLowerCase();
      
      // Zapisz imiƒô je≈õli podane
      if (!userName && (lowerMessage.includes('nazywam') || lowerMessage.includes('imiƒô') || lowerMessage.includes('name'))) {
        const nameMatch = message.match(/(?:nazywam|im[iƒôe])\s+(?:si[eƒô]|mam)\s+([a-zA-ZƒÖƒô√≥≈Ç≈º≈∫ƒá≈Ñ≈õƒÑƒò√ì≈Å≈ª≈πƒÜ≈É≈ö]{2,})/i);
        if (nameMatch) {
          userName = nameMatch[1];
          return knowledge.responses.greeting_with_name.replace('{name}', userName);
        }
      }
      
      // Sprawd≈∫ powitanie
      if (knowledge.greetings.some(greet => lowerMessage.includes(greet))) {
        return userName ? knowledge.responses.greeting_with_name.replace('{name}', userName) : knowledge.responses.greeting;
      }
      
      // Sprawd≈∫ po≈ºegnanie
      if (knowledge.farewells.some(farewell => lowerMessage.includes(farewell))) {
        return knowledge.responses.thanks;
      }
      
      // Sprawd≈∫ kontakt
      if (lowerMessage.includes('kontakt') || lowerMessage.includes('telefon') || 
          lowerMessage.includes('email') || lowerMessage.includes('nummer') || lowerMessage.includes('kontaktieren')) {
        return knowledge.responses.contact_info;
      }
      
      // Sprawd≈∫ region
      if (knowledge.areas.some(area => lowerMessage.includes(area))) {
        return `Dzia≈Çamy w tym regionie! ${knowledge.responses.service_question}`;
      }
      
      // Sprawd≈∫ wycenƒô
      if (lowerMessage.includes('wycen') || lowerMessage.includes('cena') || lowerMessage.includes('preis') || 
          lowerMessage.includes('koszt') || lowerMessage.includes('kosten') || lowerMessage.includes('angebot')) {
        return knowledge.responses.quote_request;
      }
      
      // Sprawd≈∫ um√≥wienie spotkania
      if (lowerMessage.includes('um√≥w') || lowerMessage.includes('termin') || 
          lowerMessage.includes('spotkanie') || lowerMessage.includes('vereinbaren')) {
        return knowledge.responses.appointment_setup;
      }
      
      // Sprawd≈∫ szczeg√≥≈Çy us≈Çugi
      for (const [serviceKey, serviceData] of Object.entries(knowledge.services)) {
        if (lowerMessage.includes(serviceKey)) {
          let response = `**${serviceKey.charAt(0).toUpperCase() + serviceKey.slice(1)}**\n\n`;
          response += `${serviceData.description}\n\n`;
          response += `**Szczeg√≥≈Çy:**\n${serviceData.details}\n\n`;
          response += `**Czas realizacji:** ${serviceData.time}\n`;
          response += `**Gwarancja:** ${serviceData.warranty}\n\n`;
          response += `**Przybli≈ºona cena:** ${knowledge.prices[serviceKey]}\n\n`;
          response += knowledge.responses.default.split('?')[0] + '?';
          
          return response;
        }
      }
      
      // Sprawd≈∫ cenƒô konkretnej us≈Çugi
      for (const [serviceKey, price] of Object.entries(knowledge.prices)) {
        if (lowerMessage.includes(serviceKey) && (lowerMessage.includes('cena') || lowerMessage.includes('preis'))) {
          return `**${serviceKey.charAt(0).toUpperCase() + serviceKey.slice(1)}** - ${price}`;
        }
      }
      
      // Domy≈õlna odpowied≈∫
      return knowledge.responses.default.replace('{query}', message);
    }

    function sendMessage() {
      const input = document.getElementById('chatbotInput');
      const message = input.value.trim();
      
      if (message === '') return;
      
      // Dodaj wiadomo≈õƒá u≈ºytkownika
      addUserMessage(message);
      input.value = '';
      autoResize(input);
      
      // Symuluj pisanie bota
      const typingElement = simulateTyping();
      
      // Op√≥≈∫niona odpowied≈∫ bota
      setTimeout(() => {
        typingElement.remove();
        const response = processMessage(message);
        addBotMessage(response);
        
        // Je≈õli to pierwsza wiadomo≈õƒá, poka≈º sugestie
        if (conversationHistory.length === 2) { // 1 user + 1 bot
          setTimeout(() => {
            showServiceSuggestions();
          }, 500);
        }
      }, 1500 + Math.random() * 1000);
    }

    function sendQuickMessage(message) {
      const input = document.getElementById('chatbotInput');
      input.value = message;
      sendMessage();
    }

    function quickAction(action) {
      const actions = {
        'wycena': currentLang === 'pl' ? 'Chcƒô otrzymaƒá wycenƒô projektu' : 'Ich m√∂chte ein Angebot erhalten',
        'termin': currentLang === 'pl' ? 'Chcƒô um√≥wiƒá termin wizyt
              function quickAction(action) {
      const actions = {
        'wycena': currentLang === 'pl' ? 'Chcƒô otrzymaƒá wycenƒô projektu' : 'Ich m√∂chte ein Angebot erhalten',
        'termin': currentLang === 'pl' ? 'Chcƒô um√≥wiƒá termin wizyty' : 'Ich m√∂chte einen Termin vereinbaren',
        'kontakt': currentLang === 'pl' ? 'Proszƒô o kontakt telefoniczny' : 'Bitte um telefonische Kontaktaufnahme'
      };
      
      sendQuickMessage(actions[action]);
    }

    function attachFile() {
      // Symulacja za≈ÇƒÖczania pliku
      const input = document.getElementById('chatbotInput');
      const message = currentLang === 'pl' ? 'Chcƒô przes≈Çaƒá zdjƒôcia projektu' : 'Ich m√∂chte Projektfotos senden';
      input.value = message;
      sendMessage();
    }

    // Enter do wysy≈Çania wiadomo≈õci
    document.getElementById('chatbotInput').addEventListener('keypress', function(e) {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        sendMessage();
      }
    });

    // Automatyczne uruchomienie powitalnej wiadomo≈õci po 10 sekundach
    setTimeout(() => {
      if (!isChatbotOpen && conversationHistory.length === 0) {
        document.getElementById('notificationBadge').style.display = 'flex';
      }
    }, 10000);

    // ========== EXISTING FUNCTIONALITY ==========
    // Funkcja zmiany jƒôzyka
    function setLang(lang) {
      document.documentElement.lang = lang;
      currentLang = lang;
      document.querySelectorAll('[data-pl], [data-de]').forEach(el => {
        if (el.hasAttribute(`data-${lang}`)) {
          if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA' || el.tagName === 'SELECT') {
            el.placeholder = el.getAttribute(`data-${lang}`);
          } else if (el.tagName === 'OPTION') {
            el.textContent = el.getAttribute(`data-${lang}`);
          } else {
            el.textContent = el.getAttribute(`data-${lang}`);
          }
        }
      });
      
      // Zapisz preferencje u≈ºytkownika
      localStorage.setItem('preferredLang', lang);
    }

    // Menu mobilne
    document.getElementById('mobileMenuButton').addEventListener('click', function() {
      const menu = document.getElementById('mobileMenu');
      menu.classList.toggle('hidden');
    });

    // Zamknij menu mobilne po klikniƒôciu w link
    document.querySelectorAll('#mobileMenu a').forEach(link => {
      link.addEventListener('click', () => {
        document.getElementById('mobileMenu').classList.add('hidden');
      });
    });

    // Prosty formularz kontaktowy
    document.getElementById('contactForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const formData = new FormData(this);
      const submitBtn = this.querySelector('button[type="submit"]');
      const originalText = submitBtn.textContent;
      const currentLang = document.documentElement.lang || 'pl';
      
      // Loading state
      submitBtn.disabled = true;
      if (currentLang === 'pl') {
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Wysy≈Çanie...';
      } else {
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Senden...';
      }
      
      // Symulacja wysy≈Çania
      setTimeout(() => {
        const name = formData.get('name');
        const email = formData.get('email');
        const phone = formData.get('phone');
        const service = formData.get('service');
        const message = formData.get('message');
        
        const subject = `Wiadomo≈õƒá od ${name} - Pistrakiewicz Bau`;
        const body = `Imiƒô i nazwisko: ${name}%0AEmail: ${email}%0ATelefon: ${phone}%0AUs≈Çuga: ${service}%0AWiadomo≈õƒá: ${message}`;
        
        window.location.href = `mailto:pistrakiewicz@gmail.com?subject=${subject}&body=${body}`;
        
        showFormMessage('success', currentLang === 'pl' 
          ? 'Wiadomo≈õƒá wys≈Çana! Otw√≥rz klienta pocztowego aby doko≈Ñczyƒá wysy≈Çanie.' 
          : 'Nachricht gesendet! √ñffnen Sie Ihren E-Mail-Client, um den Versand abzuschlie√üen.');
        
        this.reset();
        
        submitBtn.disabled = false;
        submitBtn.textContent = originalText;
      }, 1500);
    });

    function showFormMessage(type, message) {
      const formMessage = document.getElementById('formMessage');
      formMessage.textContent = message;
      formMessage.className = 'mt-4 p-4 rounded-lg';
      
      if (type === 'success') {
        formMessage.classList.add('bg-green-100', 'text-green-700');
      } else {
        formMessage.classList.add('bg-red-100', 'text-red-700');
      }
      
      formMessage.classList.remove('hidden');
      
      setTimeout(() => {
        formMessage.classList.add('hidden');
      }, 5000);
    }

    // Carousel dla opinii
    let currentReviewSet = 0;
    const reviewSets = document.querySelectorAll('.carousel-item');
    const dots = document.querySelectorAll('.carousel-dot');

    function showReviewSet(index) {
      reviewSets.forEach(set => set.classList.remove('active'));
      dots.forEach(dot => dot.classList.remove('active'));
      
      reviewSets[index].classList.add('active');
      dots[index].classList.add('active');
      currentReviewSet = index;
    }

    // Automatyczna zmiana opinii co 12 godzin
    setInterval(() => {
      const nextSet = (currentReviewSet + 1) % reviewSets.length;
      showReviewSet(nextSet);
    }, 43200000);

    // Rƒôczna zmiana przez kropki
    dots.forEach(dot => {
      dot.addEventListener('click', () => {
        const index = parseInt(dot.getAttribute('data-index'));
        showReviewSet(index);
      });
    });

    // Toggle dla sekcji prawnych
    document.querySelectorAll('.legal-toggle').forEach(toggle => {
      toggle.addEventListener('click', function() {
        const target = this.getAttribute('data-target');
        const section = document.getElementById(target);
        const icon = this.querySelector('i');
        
        section.classList.toggle('open');
        icon.classList.toggle('fa-chevron-down');
        icon.classList.toggle('fa-chevron-up');
      });
    });

    // P≈Çynne przewijanie do sekcji
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        
        const targetId = this.getAttribute('href');
        if (targetId === '#') return;
        
        const targetElement = document.querySelector(targetId);
        if (targetElement) {
          window.scrollTo({
            top: targetElement.offsetTop - 80,
            behavior: 'smooth'
          });
        }
      });
    });

    // Back to Top Button
    const backToTopButton = document.getElementById('backToTop');
    
    window.addEventListener('scroll', () => {
      if (window.pageYOffset > 300) {
        backToTopButton.classList.remove('hidden');
      } else {
        backToTopButton.classList.add('hidden');
      }
    });
    
    backToTopButton.addEventListener('click', () => {
      window.scrollTo({
        top: 0,
        behavior: 'smooth'
      });
    });

    // Gallery Modal
    function openModal(imageSrc) {
      const modal = document.getElementById('galleryModal');
      const modalImage = document.getElementById('modalImage');
      modalImage.src = imageSrc;
      modal.classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    }

    function closeModal() {
      const modal = document.getElementById('galleryModal');
      modal.classList.add('hidden');
      document.body.style.overflow = 'auto';
    }

    // Close modal on outside click
    document.getElementById('galleryModal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeModal();
      }
    });

    // Cookie Banner
    function checkCookies() {
      if (!localStorage.getItem('cookiesAccepted')) {
        document.getElementById('cookieBanner').classList.remove('hidden');
      }
    }

    function acceptCookies() {
      localStorage.setItem('cookiesAccepted', 'true');
      document.getElementById('cookieBanner').classList.add('hidden');
    }

    // Scroll Animations
    function checkScroll() {
      const elements = document.querySelectorAll('.fade-in');
      elements.forEach(element => {
        const elementTop = element.getBoundingClientRect().top;
        const elementVisible = 150;
        
        if (elementTop < window.innerHeight - elementVisible) {
          element.classList.add('visible');
        }
      });
    }

    // Loading Spinner
    window.addEventListener('load', function() {
      setTimeout(() => {
        document.getElementById('loading').style.display = 'none';
        checkCookies();
        checkScroll();
      }, 1000);
    });

    window.addEventListener('scroll', checkScroll);

    // Przy ≈Çadowaniu strony
    document.addEventListener('DOMContentLoaded', function() {
      const savedLang = localStorage.getItem('preferredLang') || 'pl';
      setLang(savedLang);
      
      // Add fade-in class to sections
      document.querySelectorAll('section').forEach(section => {
        section.classList.add('fade-in');
      });
    });
  </script>

</body>
</html>
        
